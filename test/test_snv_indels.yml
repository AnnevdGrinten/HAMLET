- name: test-snv-indels-dry-run-single
  tags:
    - dry-run
  command: >
    snakemake -n
    --snakefile includes/snv-indels/Snakefile
    --configfile test/data/config/test-dry-run-single.config
  stdout:
    contains:
      - "Job counts:"
      - "TestSample/snv-indels/variant_plots"

- name: test-snv-indels-dry-run-trio
  tags:
    - dry-run
  command: >
    snakemake -n
    --snakefile includes/snv-indels/Snakefile
    --configfile test/data/config/test-dry-run-trio.config
  stdout:
    contains:
      - "Job counts:"
      - "TestSample1/snv-indels/variant_plots"
      - "TestSample2/snv-indels/variant_plots"
      - "TestSample3/snv-indels/variant_plots"

- name: test-snv-indels-sanity-snakemake
  tags:
    - sanity
  command: >
    snakemake --version
  stdout:
    contains:
      - "5.9"

- name: test-snv-indels-sanity-singularity
  tags:
    - sanity
  command: >
    singularity --version
  stdout:
    contains:
      - "singularity version 3.1"

- name: test-p53-integration-NB-4
  tags:
    - integration
  command: >
      snakemake -rp
      --use-singularity
      --singularity-args ' --containall --bind /tmp/:/tmp,/exports/:/exports/'
      --singularity-prefix /exports/hem-leukemia/testing/singularity
      --snakefile includes/snv-indels/Snakefile
      --configfile test/data/config/test-p53-NB4.config
      --latency-wait 120
      --verbose
  files:
    - path: "NB4/snv-indels/NB4.raw.vcf.gz"
      contains:
        - "chr17\t7674220\t.\tC\tT\t.\tPASS"
    - path: "NB4/snv-indels/NB4.annotated.vcf.gz"
      contains:
        - "chr17\t7674220\t.\tC\tT\t.\tPASS\tADP=416;WT=0;HET=0;HOM=1;NC=0;CSQ=T|missense_variant|MODERATE|TP53|ENSG00000141510|Transcript|ENST00000269305|protein_coding|7/11||ENST00000269305.8:c.743G>A"
    - path: "NB4/snv-indels/NB4.aln_stats"
    - path: "NB4/snv-indels/NB4.vep_stats.txt"
    - path: "NB4/snv-indels/NB4.variants.json"
    - path: "NB4/snv-indels/NB4.exon_cov_stats.json"
    - path: "NB4/snv-indels/NB4.snv-indel.bam"
    - path: "NB4/snv-indels/NB4.snv-indel.bai"
    - path: "NB4/snv-indels/NB4.insert_stats.pdf"
    - path: "NB4/snv-indels/NB4.insert_stats"
      contains:
        - "MEDIAN_INSERT_SIZE\tMODE_INSERT_SIZE\tMEDIAN_ABSOLUTE_DEVIATION\tMIN_INSERT_SIZE\tMAX_INSERT_SIZE\tMEAN_INSERT_SIZE\tSTANDARD_DEVIATION\tREAD_PAIRS\tPAIR_ORIENTATION"
        - "177\t128\t54\t31\t20794276\t199.914744\t106.425583\t7016\tFR"
    - path: "NB4/snv-indels/NB4.rna_stats.pdf"
    - path: "NB4/snv-indels/NB4.rna_stats"
      contains:
        - "PF_BASES\tPF_ALIGNED_BASES\tRIBOSOMAL_BASES\tCODING_BASES\tUTR_BASES\tINTRONIC_BASES\tINTERGENIC_BASES\tIGNORED_READS\tCORRECT_STRAND_READS\tINCORRECT_STRAND_READS\tNUM_R1_TRANSCRIPT_STRAND_READS\tNUM_R2_TRANSCRIPT_STRAND_READS\tNUM_UNEXPLAINED_READS"
        - "1320386\t1289751\t0\t562538\t680479\t46273\t461\t0\t0\t0\t2802\t3145\t79"
