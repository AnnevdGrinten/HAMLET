# Hamlet

Hamlet is a pipeline for analysis of human acute myeloid leukemia RNA-seq samples. It is based on the
[Snakemake workflow management system](https://snakemake.readthedocs.io/en/stable/). Four distinct analysi modules
comprise Hamlet:

  1. `snv-indels`, for small variant detection
  2. `fusion`, for fusion gene detection
  3. `itd`, for tandem duplication detection
  4. `expression`, for expression analysis

There is also a `qc-seq` module which does quality control for input sequence files. Everything is tied together by
a main [`Snakefile`](https://snakemake.readthedocs.io/en/stable/executable.html#useful-command-line-arguments) using
the [`include`](https://snakemake.readthedocs.io/en/stable/snakefiles/modularization.html#includes) statement.

Configurations and input file definitions are supplied in a single YAML configuration file. Here you can specify
arbitrary number of samples, each containing an arbitrary number of paired-end files. The merging of these files and
separation of output per-sample are taken care of automatically by Hamlet. Additionally, if you mayalso supply your own
cluster-specific YAML configuration to determine how much resource such as memory or CPU cores should be allocated to
the jobs.

Hamlet tries to make use of isolated conda environment per Snakemake rule whenever possible. The base execution
environment is also defined by an `environment.yml` file.

In addition to the raw output files, Hamlet also generates a PDF report containing an overview of the essential results
and a zipped file containing this report and the essential result files.

The following diagram shows an overview of the Snakemake rules that are executed by Hamlet:


# Steps

```plantuml
digraph snakemake_dag {
	graph [bgcolor=white, margin=0];
	rankdir=LR;
	node [fontname=sans, fontsize=10, label="\N", penwidth=2, shape=box, style=rounded];
	edge [color=grey, penwidth=2 ];
	0	[color="0.13 0.6 0.85",
		height=0.5,
		label=all,
		pos="1143,18",
		width=0.75];
	1	 [color="0.38 0.6 0.85",
		height=0.5,
		label=fusioncatcher_cp,
		pos="1974,666",
		width=1.375];
	1 -> 0	 [pos="e,1170.2,18.432 1988.9,647.52 1996.2,637.53 2004.7,624.67 2010,612 2025.8,574.31 2029,562.88 2029,522 2029,522 2029,522 2029,162 \
2029,80.798 1947.7,95.578 1870,72 1738.9,32.234 1309.9,21.111 1180.4,18.622"];
	10	 [color="0.05 0.6 0.85",
		height=0.5,
		label=intersect_fusions,
		pos="1879,594",
		width=1.3889];
	1 -> 10	 [pos="e,1903,612.16 1950,647.83 1938.2,638.88 1923.8,627.96 1911.1,618.3"];
	34	 [color="0.29 0.6 0.85",
		height=0.5,
		label=plot_fc,
		pos="1974,594",
		width=0.75];
	1 -> 34	 [pos="e,1974,612.41 1974,647.83 1974,640.13 1974,630.97 1974,622.42"];
	2	 [color="0.21 0.6 0.85",
		height=0.5,
		label=annotate_vars,
		pos="978,450",
		width=1.1944];
	2 -> 0	 [pos="e,1116,19.049 943.16,431.97 840.59,376.69 554.17,205.27 673,72 701.7,39.811 999.69,24.091 1105.8,19.484"];
	19	 [color="0.44 0.6 0.85",
		height=0.5,
		label=create_summary,
		pos="1087,234",
		width=1.375];
	2 -> 19	 [pos="e,1072.7,252.39 984.55,431.94 995.92,401.41 1020.8,338.03 1049,288 1054.2,278.71 1060.7,269.05 1066.8,260.5"];
	38	 [color="0.26 0.6 0.85",
		height=0.5,
		label=extract_vars,
		pos="938,378",
		width=1.0694];
	2 -> 38	 [pos="e,948.23,396.41 967.91,431.83 963.44,423.79 958.09,414.17 953.16,405.29"];
	3	 [color="0.09 0.6 0.85",
		height=0.5,
		label=count_bases_exon,
		pos="572,378",
		width=1.4861];
	3 -> 0	 [pos="e,1115.6,18.722 518.34,367.59 505.16,365.06 491.07,362.41 478,360 432.73,351.67 305.03,358.01 274,324 198.5,241.26 189.36,148.69 \
271,72 301.86,43.007 942.61,23.501 1105.6,18.996"];
	13	 [color="0.60 0.6 0.85",
		height=0.5,
		label=package_results,
		pos="730,90",
		width=1.3333];
	3 -> 13	 [pos="e,725.78,108.17 598.53,359.87 610.91,350.35 625.07,337.8 635,324 682.65,257.81 711.21,164.27 723.26,118.07"];
	25	 [color="0.59 0.6 0.85",
		height=0.5,
		label=calc_exon_ratios,
		pos="577,306",
		width=1.3611];
	3 -> 25	 [pos="e,575.72,324.41 573.26,359.83 573.8,352.13 574.43,342.97 575.03,334.42"];
	4	 [color="0.47 0.6 0.85",
		height=0.5,
		label=detect_flt3,
		pos="103,378",
		width=0.94444];
	4 -> 0	 [pos="e,1115.7,18.632 97.274,359.57 89.348,332.38 76,279.78 76,234 76,234 76,234 76,162 76,94.62 134.62,94.872 198,72 284.4,40.819 940.75,\
22.912 1105.6,18.878"];
	4 -> 13	 [pos="e,681.87,95.302 136.13,359.81 193.8,327.42 315.13,255.98 406,180 422.88,165.88 420.68,154.53 440,144 479.14,122.67 599.12,105.38 \
671.92,96.499"];
	28	 [color="0.63 0.6 0.85",
		height=0.5,
		label=plot_itd_flt3,
		pos="320,306",
		width=1.0278];
	4 -> 28	 [pos="e,282.87,318.32 137.38,366.59 174.04,354.43 232.31,335.1 273.15,321.55"];
	5	 [color="0.16 0.6 0.85",
		height=0.5,
		label=plot_cp,
		pos="1720,378",
		width=0.75];
	5 -> 0	 [pos="e,1170.2,18.776 1720.4,359.82 1721,332.5 1722,279.25 1722,234 1722,234 1722,234 1722,162 1722,103.84 1679.8,96.496 1627,72 1547.6,\
35.108 1279.6,22.56 1180.4,19.117"];
	17	 [color="0.54 0.6 0.85",
		height=0.5,
		label=combine_plots,
		pos="1474,306",
		width=1.2222];
	5 -> 17	 [pos="e,1518.4,319 1692.7,370.02 1653.2,358.45 1579.2,336.78 1528.3,321.88"];
	6	 [color="0.52 0.6 0.85",
		height=0.5,
		label=star_fusion_cp,
		pos="1758,666",
		width=1.2083];
	6 -> 0	 [pos="e,1170.1,19.379 1766.6,647.98 1783.2,611.49 1818,525.89 1818,450 1818,450 1818,450 1818,162 1818,106.37 1781.2,96.046 1731,72 1681.4,\
48.236 1302,26.38 1180.4,19.922"];
	6 -> 10	 [pos="e,1848.5,612.16 1788.5,647.83 1804,638.62 1823,627.33 1839.6,617.47"];
	16	 [color="0.56 0.6 0.85",
		height=0.5,
		label=subset_sf,
		pos="1758,522",
		width=0.875];
	6 -> 16	 [pos="e,1758,540.09 1758,647.76 1758,623.2 1758,579.25 1758,550.35"];
	39	 [color="0.27 0.6 0.85",
		height=0.5,
		label=plot_sf,
		pos="1679,522",
		width=0.75];
	6 -> 39	 [pos="e,1688.9,540.09 1748,647.76 1734.3,622.88 1709.8,578.08 1693.9,549.22"];
	7	 [color="0.50 0.6 0.85",
		height=0.5,
		label=generate_report,
		pos="1086,162",
		width=1.3194];
	7 -> 0	 [pos="e,1135.8,36.09 1093.2,143.76 1103,118.98 1120.6,74.471 1132.1,45.594"];
	7 -> 13	 [pos="e,778.21,99.751 1038.4,152.36 973.62,139.27 857.95,115.88 788.17,101.76"];
	8	 [color="0.08 0.6 0.85",
		height=0.5,
		label=align_flt3,
		pos="103,450",
		width=0.86111];
	8 -> 0	 [pos="e,1115.8,18.585 73.543,431.84 60.312,422.48 45.377,410.08 35,396 9.5325,361.45 0,348.92 0,306 0,306 0,306 0,162 0,116.67 9.7134,\
96.274 48,72 93.606,43.085 919.07,22.995 1105.7,18.81"];
	8 -> 4	 [pos="e,103,396.41 103,431.83 103,424.13 103,414.97 103,406.42"];
	9	 [color="0.24 0.6 0.85",
		height=0.5,
		label=insert_stats,
		pos="1213,306",
		width=1.0278];
	9 -> 0	 [pos="e,1170.3,22.555 1250.2,290.97 1307.1,265.53 1406,210.21 1374,144 1337.7,68.901 1235.6,36.827 1180.1,24.61"];
	9 -> 19	 [pos="e,1118.8,252.16 1181.2,287.83 1164.9,278.54 1145,267.12 1127.6,257.2"];
	10 -> 0	 [pos="e,1170.3,18.759 1881.1,575.82 1885.3,538.71 1894,451.49 1894,378 1894,378 1894,378 1894,162 1894,113.43 1874.1,96.257 1832,72 1775.4,\
39.367 1316.2,23.169 1180.6,19.066"];
	10 -> 16	 [pos="e,1788.5,540.16 1848.5,575.83 1833,566.62 1814,555.33 1797.4,545.47"];
	11	 [color="0.34 0.6 0.85",
		height=0.5,
		label=align_kmt2a,
		pos="427,450",
		width=1.0694];
	11 -> 0	 [pos="e,1115.8,18.71 388.44,446.76 299.18,438.91 84.078,417.92 60,396 29.552,368.28 38,347.18 38,306 38,306 38,306 38,162 38,114.17 55.518,\
95.809 97,72 141.6,46.401 924.33,23.873 1105.7,18.982"];
	12	 [color="0.22 0.6 0.85",
		height=0.5,
		label=detect_kmt2a,
		pos="427,378",
		width=1.1667];
	11 -> 12	 [pos="e,427,396.41 427,431.83 427,424.13 427,414.97 427,406.42"];
	12 -> 0	 [pos="e,1115.7,18.804 384.99,369.99 337.5,360.21 264.06,342.65 243,324 159.14,249.73 147.47,137.97 238,72 273.59,46.064 938.82,24.2 1105.4,\
19.115"];
	12 -> 13	 [pos="e,699.98,108 445.39,359.9 455.9,349.48 469.28,336.09 481,324 557.36,245.19 566.45,215.14 650,144 662.77,133.13 677.78,122.5 691.33,\
113.6"];
	23	 [color="0.12 0.6 0.85",
		height=0.5,
		label=plot_itd_kmt2a,
		pos="427,306",
		width=1.25];
	12 -> 23	 [pos="e,427,324.41 427,359.83 427,352.13 427,342.97 427,334.42"];
	13 -> 0	 [pos="e,1116,22.712 778.18,81.6 861.61,67.056 1031.2,37.494 1106.1,24.441"];
	14	 [color="0.35 0.6 0.85",
		height=0.5,
		label=rna_stats,
		pos="1299,306",
		width=0.86111];
	14 -> 0	 [pos="e,1170.1,19.64 1321.8,287.79 1354.7,259.03 1410,200.55 1392,144 1380.1,106.63 1373.1,94.477 1341,72 1292.1,37.829 1222.6,25.258 \
1180.2,20.649"];
	14 -> 19	 [pos="e,1136.8,247.94 1267.7,291.49 1264.8,290.27 1261.8,289.08 1259,288 1222.1,273.97 1179.9,260.67 1146.5,250.77"];
	15	 [color="0.04 0.6 0.85",
		height=0.5,
		label=merge_fastqs,
		pos="1377,810",
		width=1.1528];
	15 -> 0	 [pos="e,1170.1,20.174 1418.9,800.83 1479.4,784.84 1584,745.68 1584,666 1584,666 1584,666 1584,162 1584,103.52 1540.6,97.66 1488,72 1434.2,\
45.738 1258.1,27.862 1180.4,21.06"];
	15 -> 8	 [pos="e,134.08,457.8 1335.2,808.18 1203.5,802.23 798.61,782.24 670,756 547.71,731.05 404,790.81 404,666 404,666 404,666 404,594 404,537 \
226.13,482.54 143.85,460.4"];
	15 -> 11	 [pos="e,465.62,467.27 1335.2,806.99 1170.4,794.54 574,744.12 574,666 574,666 574,666 574,594 574,537.3 517.5,495.56 474.56,472.02"];
	35	 [color="0.55 0.6 0.85",
		height=0.5,
		label=star_fusion,
		pos="1648,738",
		width=0.98611];
	15 -> 35	 [pos="e,1612.4,751.34 1418.9,801.15 1463.6,791.38 1536.4,774.57 1598,756 1599.5,755.56 1600.9,755.1 1602.4,754.63"];
	44	 [color="0.18 0.6 0.85",
		height=0.5,
		label=align_vars,
		pos="1336,738",
		width=0.93056];
	15 -> 44	 [pos="e,1346.5,756.41 1366.7,791.83 1362.1,783.79 1356.6,774.17 1351.5,765.29"];
	16 -> 0	 [pos="e,1170.3,18.584 1762.6,503.95 1769,476.81 1780,423.78 1780,378 1780,378 1780,378 1780,162 1780,101.21 1732.8,96.202 1677,72 1587.4,\
33.131 1286.7,21.713 1180.5,18.849"];
	41	 [color="0.17 0.6 0.85",
		height=0.5,
		label=plot_isect,
		pos="1720,450",
		width=0.88889];
	16 -> 41	 [pos="e,1729.7,468.41 1748.4,503.83 1744.2,495.79 1739.1,486.17 1734.4,477.29"];
	17 -> 0	 [pos="e,1170.3,20.247 1474.3,287.82 1473.8,243.62 1466.2,129.91 1402,72 1369.8,42.942 1244,27.358 1180.3,21.191"];
	17 -> 13	 [pos="e,778,91.287 1445.1,287.87 1389,253.62 1260.5,179.65 1142,144 1019.7,107.21 869.49,95.482 788.49,91.744"];
	17 -> 19	 [pos="e,1136.5,241.03 1430,290.68 1426.6,289.71 1423.3,288.8 1420,288 1369.3,275.54 1228,254.27 1146.6,242.49"];
	18	 [color="0.61 0.6 0.85",
		height=0.5,
		label=aln_stats,
		pos="1089,306",
		width=0.84722];
	18 -> 0	 [pos="e,1153.9,36.287 1113.5,287.96 1124.7,278.46 1137.2,265.9 1145,252 1184.5,181.66 1185.3,150.76 1168,72 1166,63.008 1162.4,53.732 \
1158.5,45.46"];
	18 -> 19	 [pos="e,1087.5,252.41 1088.5,287.83 1088.3,280.13 1088,270.97 1087.8,262.42"];
	19 -> 0	 [pos="e,1147.2,36.158 1113.2,215.8 1124.3,206.51 1136,194.17 1142,180 1160.5,136.18 1155,79.52 1149.1,46.134"];
	19 -> 7	 [pos="e,1086.3,180.41 1086.7,215.83 1086.6,208.13 1086.5,198.97 1086.4,190.42"];
	19 -> 13	 [pos="e,778.25,107.61 1037.2,227.53 995.04,220.48 934.21,206.47 887,180 866.71,168.62 868.3,156.99 849,144 830.15,131.32 807.84,120.3 \
787.66,111.57"];
	20	 [color="0.14 0.6 0.85",
		height=0.5,
		label=sample_stats,
		pos="1653,306",
		width=1.1389];
	20 -> 0	 [pos="e,1170.2,19.429 1655,287.98 1658.7,243.63 1661.5,128.71 1598,72 1567,44.331 1283.7,25.866 1180.5,20.004"];
	20 -> 19	 [pos="e,1136.5,239.76 1611.9,299.92 1587.3,296.33 1555.4,291.77 1527,288 1391,269.94 1231.1,250.85 1146.5,240.92"];
	21	 [color="0.65 0.6 0.85",
		height=0.5,
		label=table_vars_all,
		pos="939,162",
		width=1.1806];
	21 -> 0	 [pos="e,1116,22.471 946.16,143.96 955.03,123.79 971.97,91.401 996,72 1028.3,45.957 1074.2,31.78 1106.2,24.573"];
	21 -> 13	 [pos="e,778.34,106.65 896.45,147.34 865.14,136.56 822.22,121.77 787.8,109.91"];
	22	 [color="0.00 0.6 0.85",
		height=0.5,
		label=table_vars_hi,
		pos="799,162",
		width=1.1389];
	22 -> 0	 [pos="e,1116,24.13 827.21,143.97 858.99,124.25 912.67,92.696 962,72 1010.4,51.708 1069,35.691 1106.1,26.53"];
	22 -> 13	 [pos="e,747.65,108.41 781.59,143.83 773.48,135.37 763.68,125.15 754.82,115.9"];
	23 -> 0	 [pos="e,1116,19.001 388.3,287.8 333.12,259.29 242.54,201.41 281,144 327.81,74.126 374.2,91.532 456,72 581.23,42.1 981.48,24.307 1105.8,\
19.398"];
	23 -> 13	 [pos="e,681.62,97.848 447.12,287.87 457.29,277.97 469.28,265.09 478,252 507.12,208.28 486.02,178.07 526,144 547.83,125.4 619.26,109.35 \
671.46,99.694"];
	23 -> 19	 [pos="e,1037.4,237.07 472.24,296.23 487.08,293.27 503.7,290.22 519,288 703.34,261.27 923.33,244.67 1027.1,237.74"];
	24	 [color="0.58 0.6 0.85",
		height=0.5,
		label=plot_vars,
		pos="971,306",
		width=0.86111];
	24 -> 0	 [pos="e,1122.2,36.135 974.99,287.98 982.39,256.96 1000.1,192.18 1029,144 1052.5,104.78 1089.3,66.872 1114.7,43.059"];
	24 -> 13	 [pos="e,729.61,108.32 939.62,297.33 890.76,282.12 797.13,245.83 749,180 736.02,162.24 731.51,137.54 730.11,118.51"];
	24 -> 19	 [pos="e,1057.7,252.16 1000.3,287.83 1015.1,278.62 1033.3,267.33 1049.2,257.47"];
	25 -> 0	 [pos="e,1115.7,18.744 572.28,287.9 562.01,243.89 543.01,130.59 602,72 637.68,36.566 988.82,22.706 1105.5,19.056"];
	25 -> 13	 [pos="e,710.69,108.11 586.75,287.69 603.57,256.79 639.9,192.89 678,144 685.67,134.15 694.89,124.11 703.43,115.39"];
	25 -> 19	 [pos="e,1037.2,241.03 626.36,299.03 720.5,285.74 925.34,256.82 1027.1,242.45"];
	26	 [color="0.43 0.6 0.85",
		height=0.5,
		label=count_bases_gene,
		pos="344,162",
		width=1.4861];
	26 -> 0	 [pos="e,1115.9,19.463 379.11,143.83 421.65,122.72 496.07,88.671 564,72 667.65,46.563 995.03,26.309 1105.9,20.027"];
	26 -> 13	 [pos="e,681.79,96.796 397.71,147.3 402.53,146.13 407.35,145.01 412,144 502.13,124.46 607.9,107.71 671.89,98.252"];
	27	 [color="0.07 0.6 0.85",
		height=0.5,
		label=count_fragments,
		pos="1316,162",
		width=1.375];
	27 -> 0	 [pos="e,1170.3,27.18 1306.6,143.75 1295.7,123.98 1276.1,92.532 1252,72 1230.7,53.852 1202.3,40.031 1179.8,30.916"];
	27 -> 13	 [pos="e,778.19,95.717 1266.4,155.54 1239.7,152.07 1206,147.75 1176,144 1036.9,126.64 873.34,107.04 788.18,96.906"];
	28 -> 0	 [pos="e,1115.6,18.278 306.99,287.73 300.26,277.59 292.35,264.53 287,252 274.01,221.56 272.26,212.82 268,180 261.35,128.76 266.92,98.944 \
311,72 379.37,30.211 951.96,20.313 1105.3,18.402"];
	28 -> 13	 [pos="e,681.76,94.055 334.28,287.95 362.02,254.15 426.78,181.4 498,144 552.86,115.19 622.98,101.61 671.71,95.294"];
	28 -> 19	 [pos="e,1037.3,236.13 357.03,292.11 362.33,290.51 367.76,289.07 373,288 497.52,262.57 878.61,243.31 1027,236.59"];
	29	 [color="0.30 0.6 0.85",
		height=0.5,
		label=exon_cov,
		pos="1380,306",
		width=0.875];
	29 -> 0	 [pos="e,1170.4,21.383 1387.2,287.74 1403.8,242.34 1438.6,124.23 1374,72 1344.5,48.18 1238,30.699 1180.5,22.755"];
	29 -> 19	 [pos="e,1136.6,241.56 1348.5,291.4 1345.3,290.16 1342.1,289 1339,288 1274.5,267.18 1198.2,252.1 1146.5,243.25"];
	30	 [color="0.64 0.6 0.85",
		height=0.5,
		label=reorder_aln_header,
		pos="1213,594",
		width=1.5417];
	30 -> 0	 [pos="e,1170.4,18.905 1268.7,581.98 1363.5,559.91 1546,509.68 1546,450 1546,450 1546,450 1546,162 1546,96.747 1489.5,98.781 1430,72 1346.2,\
34.271 1237.1,22.898 1180.6,19.473"];
	30 -> 9	 [pos="e,1213,324.01 1213,575.98 1213,527.29 1213,392.8 1213,334.06"];
	30 -> 14	 [pos="e,1293.6,324.01 1218.4,575.98 1232.9,527.19 1273.2,392.24 1290.7,333.69"];
	30 -> 18	 [pos="e,1085.2,324.01 1157.4,576.99 1139.4,568.7 1121.2,556.79 1110,540 1067.7,476.59 1076,381.01 1083.5,334.06"];
	30 -> 29	 [pos="e,1359.9,324.13 1226.1,575.99 1233.3,565.71 1242.2,552.44 1249,540 1291.2,463.3 1280.5,432.87 1329,360 1335.7,349.87 1344.4,339.87 \
1352.7,331.29"];
	32	 [color="0.01 0.6 0.85",
		height=0.5,
		label=call_vars,
		pos="1005,522",
		width=0.83333];
	30 -> 32	 [pos="e,1035,532.39 1160.8,575.92 1124.8,563.47 1077.7,547.16 1044.7,535.76"];
	33	 [color="0.48 0.6 0.85",
		height=0.5,
		label=count_raw_bases,
		pos="572,450",
		width=1.4028];
	30 -> 33	 [pos="e,622.66,461.73 1157.1,581.92 1107,571.08 1031.5,554.65 966,540 847.88,513.6 710.04,481.91 632.7,464.05"];
	40	 [color="0.42 0.6 0.85",
		height=0.5,
		label=idsort_aln,
		pos="1152,522",
		width=0.90278];
	30 -> 40	 [pos="e,1167.6,540.41 1197.6,575.83 1190.5,567.45 1182,557.35 1174.2,548.17"];
	31	 [color="0.20 0.6 0.85",
		height=0.5,
		label=fusioncatcher,
		pos="1974,738",
		width=1.1528];
	31 -> 1	 [pos="e,1974,684.41 1974,719.83 1974,712.13 1974,702.97 1974,694.42"];
	32 -> 2	 [pos="e,984.9,468.41 998.19,503.83 995.24,495.96 991.71,486.57 988.44,477.85"];
	33 -> 3	 [pos="e,572,396.41 572,431.83 572,424.13 572,414.97 572,406.42"];
	33 -> 26	 [pos="e,325.28,180.36 521.17,441.03 480.57,432.69 422.9,418.18 376,396 325.84,372.28 299.53,373.27 274,324 249.83,277.35 289.44,220.52 \
318.24,188.07"];
	34 -> 5	 [pos="e,1741.3,396.15 1952.8,575.96 1907.4,537.36 1800.8,446.74 1749.1,402.78"];
	35 -> 6	 [pos="e,1730.3,684.16 1675.8,719.83 1689.7,710.71 1706.8,699.54 1721.7,689.74"];
	36	 [color="0.33 0.6 0.85",
		height=0.5,
		label=clip_trim_sync,
		pos="1651,882",
		width=1.2083];
	36 -> 15	 [pos="e,1418.8,820.98 1607.3,870.51 1558.7,857.75 1480.3,837.15 1428.7,823.59"];
	47	 [color="0.39 0.6 0.85",
		height=0.5,
		label=fastqc_processed,
		pos="1651,810",
		width=1.4028];
	36 -> 47	 [pos="e,1651,828.41 1651,863.83 1651,856.13 1651,846.97 1651,838.42"];
	37	 [color="0.03 0.6 0.85",
		height=0.5,
		label=rg_stats,
		pos="1730,738",
		width=0.77778];
	37 -> 20	 [pos="e,1646.4,324.37 1703.9,719.88 1671.9,695.36 1622,648.38 1622,594 1622,594 1622,594 1622,450 1622,409 1634.2,362.88 1643.2,334.13"];
	38 -> 21	 [pos="e,936.72,180.47 935.01,359.56 933.47,349.15 931.77,335.89 931,324 927.99,277.29 932.26,222.95 935.63,190.57"];
	38 -> 22	 [pos="e,810.68,180.15 926.39,359.96 901.91,321.92 844.91,233.34 816.19,188.71"];
	38 -> 24	 [pos="e,962.56,324.41 946.33,359.83 949.97,351.88 954.33,342.37 958.36,333.57"];
	39 -> 5	 [pos="e,1701.4,396.19 1675.7,503.87 1673,485.29 1671,455.84 1679,432 1682.4,421.96 1688.5,412.3 1694.9,404.01"];
	40 -> 27	 [pos="e,1281.5,180.09 1148.6,503.75 1141.8,462.64 1130.4,360.72 1167,288 1190,242.39 1237.5,206.81 1272.8,185.26"];
	41 -> 5	 [pos="e,1720,396.41 1720,431.83 1720,424.13 1720,414.97 1720,406.42"];
	42	 [color="0.41 0.6 0.85",
		height=0.5,
		label=genome_txt,
		pos="1376,378",
		width=1.0417];
	42 -> 29	 [pos="e,1379,324.41 1377,359.83 1377.4,352.13 1377.9,342.97 1378.4,334.42"];
	43	 [color="0.46 0.6 0.85",
		height=0.5,
		label=exon_cov_ref,
		pos="1473,378",
		width=1.1389];
	43 -> 29	 [pos="e,1403.5,324.16 1449.5,359.83 1438,350.88 1423.9,339.96 1411.4,330.3"];
	44 -> 30	 [pos="e,1228.5,612.09 1320.4,719.76 1298.8,694.44 1259.6,648.52 1235,619.73"];
	45	 [color="0.37 0.6 0.85",
		height=0.5,
		label=merge_fastqs_raw,
		pos="1974,810",
		width=1.4861];
	45 -> 31	 [pos="e,1974,756.41 1974,791.83 1974,784.13 1974,774.97 1974,766.42"];
	46	 [color="0.25 0.6 0.85",
		height=0.5,
		label=fastqc_raw,
		pos="1690,954",
		width=0.97222];
	46 -> 36	 [pos="e,1661,900.41 1680.2,935.83 1675.8,927.79 1670.6,918.17 1665.8,909.29"];
	46 -> 37	 [pos="e,1727.4,756.06 1694.8,935.58 1697.4,925.17 1700.6,911.91 1703,900 1712.5,853.31 1721.1,798.54 1725.9,766.14"];
	47 -> 37	 [pos="e,1710.1,756.16 1670.9,791.83 1680.5,783.13 1692.1,772.58 1702.4,763.13"];
}
```

# Running

    snakemake -p -T --use-conda -s Snakefile --configfile config.yml \
        --rerun-incomplete --restart-times 3 \
        --cluster-config config-cluster.yml --jobname 'hamlet.{jobid}' \
        --jobs 100 -w 120 --max-jobs-per-second 3 \
        --drmaa ' -pe BWA {cluster.threads} -l h_vmem={cluster.vmem} -cwd -V' \
        --drmaa-log-dir .drmaa-logs
